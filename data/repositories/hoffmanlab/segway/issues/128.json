{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/hoffmanlab/segway.json"}, "html": {"href": "#!/hoffmanlab/segway"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68bf38bf-f0c1-4c9c-909e-0ee4b2c26257}ts=python"}}, "type": "repository", "name": "segway", "full_name": "hoffmanlab/segway", "uuid": "{68bf38bf-f0c1-4c9c-909e-0ee4b2c26257}"}, "links": {"attachments": {"href": "data/repositories/hoffmanlab/segway/issues/128/attachments_page=1.json"}, "self": {"href": "data/repositories/hoffmanlab/segway/issues/128.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/issues/128/watch"}, "comments": {"href": "data/repositories/hoffmanlab/segway/issues/128/comments_page=1.json"}, "html": {"href": "#!/hoffmanlab/segway/issues/128/stale-file-handle-error"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/issues/128/vote"}}, "reporter": {"display_name": "Micka\u00ebl Mendez", "uuid": "{3e035b9e-0328-44e8-8622-5c7e9ed060b2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3e035b9e-0328-44e8-8622-5c7e9ed060b2%7D"}, "html": {"href": "https://bitbucket.org/%7B3e035b9e-0328-44e8-8622-5c7e9ed060b2%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1cb7d89dcab61313d21c5ef402c28e11d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMM-0.png"}}, "nickname": "Mickael Mendez", "type": "user", "account_id": "557058:aae10d90-ba66-49cd-a04d-5392b943760d"}, "title": "Stale file handle error", "component": null, "votes": 0, "watches": 1, "content": {"raw": "While running Segway 2.0.2 in reverse mode I ran into a `Stale file handle error`. Below are the logs and the command of the job that failed.\r\n\r\n\r\n## segway command\r\n```\r\nsegway \\\r\n    --num-labels=10 \\\r\n    --resolution=2 \\\r\n    --ruler-scale=2 \\\r\n    --num-instances=10 \\\r\n    --reverse-world=1 \\\r\n    --max-train-rounds=50 \\\r\n    --seg-table=seg_table.tab \\\r\n    --minibatch-fraction=0.01 \\\r\n    --tracks-from=tracks.csv \\\r\n    --mem-usage=2,4,8,16 \\\r\n    train ...\r\n```\r\n\r\n## Segway output\r\n```\r\nTraceback (most recent call last):\r\n  File \"~/anaconda2/lib/python2.7/site-packages/luigi/worker.py\", line 181, in run\r\n    new_deps = self._run_get_new_deps()\r\n  File \"~/anaconda2/lib/python2.7/site-packages/luigi/worker.py\", line 119, in _run_get_new_deps\r\n    task_gen = self.task.run()\r\n  File \"segway_workflow.py\", line 141, in run\r\n    segway_run.main(segway_cmd)\r\n  File \"~/anaconda2/lib/python2.7/site-packages/segway/run.py\", line 3787, in main\r\n    return runner()\r\n  File \"~/anaconda2/lib/python2.7/site-packages/segway/run.py\", line 3552, in __call__\r\n    self.run(*args, **kwargs)\r\n  File \"~/anaconda2/lib/python2.7/site-packages/segway/run.py\", line 3519, in run\r\n    self.run_train()\r\n  File \"~/anaconda2/lib/python2.7/site-packages/segway/run.py\", line 2947, in run_train\r\n    instance_params = run_train_func(self.num_segs_range)\r\n  File \"~/anaconda2/lib/python2.7/site-packages/segway/run.py\", line 3030, in run_train_multithread\r\n    to find the winning instance anyway.\"\"\" % thread.instance_index)\r\nAttributeError: Training instance 0 failed. See previously printed error for reason.\r\nFinal params file will not be written. Rerun the instance or use segway-winner\r\nto find the winning instance anyway.\r\n```\r\n\r\n## EM training error\r\nThe source of the error seem to come from the job: `emt0.19.1233.train.637ed75e7b0f11e8975fbd311cda90ee`\r\n\r\n- The job's output file is empty instead of containing the expected: `____ PROGRAM ENDED SUCCESSFULLY WITH STATUS___`\r\n- Content of the Job's error output:\r\n```\r\nTraceback (most recent call last):\r\n  File \"~/anaconda2/bin/segway-task\", line 6, in <module>\r\n    sys.exit(segway.task.main())\r\n  File \"~/anaconda2/lib/python2.7/site-packages/segway/task.py\", line 592, in main\r\n    return task(*args)\r\n  File \"~/anaconda2/lib/python2.7/site-packages/segway/task.py\", line 582, in task\r\n    outfilename, *args)\r\n  File \"~/anaconda2/lib/python2.7/site-packages/segway/task.py\", line 476, in run_train\r\n    supervision_data=supervision_cells)\r\n  File \"~/anaconda2/lib/python2.7/site-packages/segway/observations.py\", line 479, in _save_window\r\n    int_data.tofile(int_filename)\r\nIOError: [Errno 116] Stale file handle\r\n```\r\n\r\nThis jobs has two unexpected behavior:\r\n\r\n- Usually the jobs raising this error are re-submitted. This one is not\r\n- The job is not indexed in  `jobs.tab`", "markup": "markdown", "html": "<p>While running Segway 2.0.2 in reverse mode I ran into a <code>Stale file handle error</code>. Below are the logs and the command of the job that failed.</p>\n<h2 id=\"markdown-header-segway-command\">segway command</h2>\n<div class=\"codehilite\"><pre><span></span>segway \\\n    --num-labels=10 \\\n    --resolution=2 \\\n    --ruler-scale=2 \\\n    --num-instances=10 \\\n    --reverse-world=1 \\\n    --max-train-rounds=50 \\\n    --seg-table=seg_table.tab \\\n    --minibatch-fraction=0.01 \\\n    --tracks-from=tracks.csv \\\n    --mem-usage=2,4,8,16 \\\n    train ...\n</pre></div>\n\n\n<h2 id=\"markdown-header-segway-output\">Segway output</h2>\n<div class=\"codehilite\"><pre><span></span>Traceback (most recent call last):\n  File &quot;~/anaconda2/lib/python2.7/site-packages/luigi/worker.py&quot;, line 181, in run\n    new_deps = self._run_get_new_deps()\n  File &quot;~/anaconda2/lib/python2.7/site-packages/luigi/worker.py&quot;, line 119, in _run_get_new_deps\n    task_gen = self.task.run()\n  File &quot;segway_workflow.py&quot;, line 141, in run\n    segway_run.main(segway_cmd)\n  File &quot;~/anaconda2/lib/python2.7/site-packages/segway/run.py&quot;, line 3787, in main\n    return runner()\n  File &quot;~/anaconda2/lib/python2.7/site-packages/segway/run.py&quot;, line 3552, in __call__\n    self.run(*args, **kwargs)\n  File &quot;~/anaconda2/lib/python2.7/site-packages/segway/run.py&quot;, line 3519, in run\n    self.run_train()\n  File &quot;~/anaconda2/lib/python2.7/site-packages/segway/run.py&quot;, line 2947, in run_train\n    instance_params = run_train_func(self.num_segs_range)\n  File &quot;~/anaconda2/lib/python2.7/site-packages/segway/run.py&quot;, line 3030, in run_train_multithread\n    to find the winning instance anyway.&quot;&quot;&quot; % thread.instance_index)\nAttributeError: Training instance 0 failed. See previously printed error for reason.\nFinal params file will not be written. Rerun the instance or use segway-winner\nto find the winning instance anyway.\n</pre></div>\n\n\n<h2 id=\"markdown-header-em-training-error\">EM training error</h2>\n<p>The source of the error seem to come from the job: <code>emt0.19.1233.train.637ed75e7b0f11e8975fbd311cda90ee</code></p>\n<ul>\n<li>The job's output file is empty instead of containing the expected: <code>____ PROGRAM ENDED SUCCESSFULLY WITH STATUS___</code></li>\n<li>Content of the Job's error output:</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span>Traceback (most recent call last):\n  File &quot;~/anaconda2/bin/segway-task&quot;, line 6, in &lt;module&gt;\n    sys.exit(segway.task.main())\n  File &quot;~/anaconda2/lib/python2.7/site-packages/segway/task.py&quot;, line 592, in main\n    return task(*args)\n  File &quot;~/anaconda2/lib/python2.7/site-packages/segway/task.py&quot;, line 582, in task\n    outfilename, *args)\n  File &quot;~/anaconda2/lib/python2.7/site-packages/segway/task.py&quot;, line 476, in run_train\n    supervision_data=supervision_cells)\n  File &quot;~/anaconda2/lib/python2.7/site-packages/segway/observations.py&quot;, line 479, in _save_window\n    int_data.tofile(int_filename)\nIOError: [Errno 116] Stale file handle\n</pre></div>\n\n\n<p>This jobs has two unexpected behavior:</p>\n<ul>\n<li>Usually the jobs raising this error are re-submitted. This one is not</li>\n<li>The job is not indexed in  <code>jobs.tab</code></li>\n</ul>", "type": "rendered"}, "assignee": null, "state": "new", "version": null, "edited_on": null, "created_on": "2018-06-29T20:53:27.163939+00:00", "milestone": null, "updated_on": "2018-07-07T19:58:58.225388+00:00", "type": "issue", "id": 128}
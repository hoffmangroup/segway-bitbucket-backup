{"priority": "minor", "kind": "enhancement", "repository": {"links": {"self": {"href": "data/repositories/hoffmanlab/segway.json"}, "html": {"href": "#!/hoffmanlab/segway"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68bf38bf-f0c1-4c9c-909e-0ee4b2c26257}ts=python"}}, "type": "repository", "name": "segway", "full_name": "hoffmanlab/segway", "uuid": "{68bf38bf-f0c1-4c9c-909e-0ee4b2c26257}"}, "links": {"attachments": {"href": "data/repositories/hoffmanlab/segway/issues/45/attachments_page=1.json"}, "self": {"href": "data/repositories/hoffmanlab/segway/issues/45.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/issues/45/watch"}, "comments": {"href": "data/repositories/hoffmanlab/segway/issues/45/comments_page=1.json"}, "html": {"href": "#!/hoffmanlab/segway/issues/45/better-checks-for-valid-genomedata"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/issues/45/vote"}}, "reporter": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "title": "Better checks for valid genomedata archives", "component": null, "votes": 0, "watches": 2, "content": {"raw": "More than once users have tried to open the HDF5 files contained within a genomedata archive (folder) and not specifying the archive (or folder) itself.\r\n\r\nThis results in the following error:\r\n\r\n```python\r\nTraceback (most recent call last):\r\n  File \"/storage/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/bin/segway\", line 9, in <module>\r\n    load_entry_point('segway===1.2.0.dev-r0', 'console_scripts', 'segway')()\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py\", line 2971, in main\r\n    return runner()\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py\", line 2735, in __call__\r\n    self.run(*args, **kwargs)\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py\", line 2697, in run\r\n    self.save_observations_params()\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py\", line 1749, in save_observations_params\r\n    self.subset_metadata(genome) # XXX: does this need to be done before save()?\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py\", line 1548, in subset_metadata\r\n    subset_metadata_attr(genome, \"mins\", min)\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py\", line 1526, in subset_metadata_attr\r\n    attr = getattr(genome, name)\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py\", line 441, in mins\r\n    return self._accum_extrema(\"mins\", partial(amin, axis=0))\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py\", line 303, in _accum_extrema\r\n    extrema = [getattr(chromosome, name) for chromosome in self]\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py\", line 176, in __iter__\r\n    yield self[groupname]\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py\", line 210, in __getitem__\r\n    res = Chromosome(self.h5file, where=\"/\" + name)\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py\", line 565, in __init__\r\n    if attrs.dirty:\r\n  File \"/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/tables-3.2.1-py2.7-linux-x86_64.egg/tables/attributeset.py\", line 288, in __getattr__\r\n    \"'%s'\" % (name, self._v__nodepath))\r\nAttributeError: Attribute 'dirty' does not exist in node: '/supercontig_0'\r\n```\r\n\r\nThis error needs to be reported better and a simple check of valid genomedata archives needs to occur before any processing (creating the observations).", "markup": "markdown", "html": "<p>More than once users have tried to open the HDF5 files contained within a genomedata archive (folder) and not specifying the archive (or folder) itself.</p>\n<p>This results in the following error:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/storage/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/bin/segway&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"n\">load_entry_point</span><span class=\"p\">(</span><span class=\"s1\">&#39;segway===1.2.0.dev-r0&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;console_scripts&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;segway&#39;</span><span class=\"p\">)()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2971</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">main</span>\n    <span class=\"k\">return</span> <span class=\"n\">runner</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2735</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"fm\">__call__</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2697</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">save_observations_params</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1749</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">save_observations_params</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">subset_metadata</span><span class=\"p\">(</span><span class=\"n\">genome</span><span class=\"p\">)</span> <span class=\"c1\"># XXX: does this need to be done before save()?</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1548</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">subset_metadata</span>\n    <span class=\"n\">subset_metadata_attr</span><span class=\"p\">(</span><span class=\"n\">genome</span><span class=\"p\">,</span> <span class=\"s2\">&quot;mins&quot;</span><span class=\"p\">,</span> <span class=\"nb\">min</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/segway-1.2.0.dev_r0-py2.7.egg/segway/run.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1526</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">subset_metadata_attr</span>\n    <span class=\"n\">attr</span> <span class=\"o\">=</span> <span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"n\">genome</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">441</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">mins</span>\n    <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_accum_extrema</span><span class=\"p\">(</span><span class=\"s2\">&quot;mins&quot;</span><span class=\"p\">,</span> <span class=\"n\">partial</span><span class=\"p\">(</span><span class=\"n\">amin</span><span class=\"p\">,</span> <span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">))</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">303</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_accum_extrema</span>\n    <span class=\"n\">extrema</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"n\">chromosome</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">chromosome</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"p\">]</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">176</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"fm\">__iter__</span>\n    <span class=\"k\">yield</span> <span class=\"bp\">self</span><span class=\"p\">[</span><span class=\"n\">groupname</span><span class=\"p\">]</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">210</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"fm\">__getitem__</span>\n    <span class=\"n\">res</span> <span class=\"o\">=</span> <span class=\"n\">Chromosome</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">h5file</span><span class=\"p\">,</span> <span class=\"n\">where</span><span class=\"o\">=</span><span class=\"s2\">&quot;/&quot;</span> <span class=\"o\">+</span> <span class=\"n\">name</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/genomedata-1.3.5-py2.7.egg/genomedata/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">565</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"fm\">__init__</span>\n    <span class=\"k\">if</span> <span class=\"n\">attrs</span><span class=\"o\">.</span><span class=\"n\">dirty</span><span class=\"p\">:</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/gpfs/home/lua137/arch/Linux-x86_64/opt/python-2.7.10/lib/python2.7/site-packages/tables-3.2.1-py2.7-linux-x86_64.egg/tables/attributeset.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">288</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"fm\">__getattr__</span>\n    <span class=\"s2\">&quot;&#39;</span><span class=\"si\">%s</span><span class=\"s2\">&#39;&quot;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_v__nodepath</span><span class=\"p\">))</span>\n<span class=\"ne\">AttributeError</span><span class=\"p\">:</span> <span class=\"n\">Attribute</span> <span class=\"s1\">&#39;dirty&#39;</span> <span class=\"n\">does</span> <span class=\"ow\">not</span> <span class=\"n\">exist</span> <span class=\"ow\">in</span> <span class=\"n\">node</span><span class=\"p\">:</span> <span class=\"s1\">&#39;/supercontig_0&#39;</span>\n</pre></div>\n\n\n<p>This error needs to be reported better and a simple check of valid genomedata archives needs to occur before any processing (creating the observations).</p>", "type": "rendered"}, "assignee": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "state": "new", "version": null, "edited_on": null, "created_on": "2015-08-27T15:15:44.787851+00:00", "milestone": null, "updated_on": "2015-08-27T17:32:53.912378+00:00", "type": "issue", "id": 45}
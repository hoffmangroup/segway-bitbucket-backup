{"priority": "trivial", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/hoffmanlab/segway.json"}, "html": {"href": "#!/hoffmanlab/segway"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68bf38bf-f0c1-4c9c-909e-0ee4b2c26257}ts=python"}}, "type": "repository", "name": "segway", "full_name": "hoffmanlab/segway", "uuid": "{68bf38bf-f0c1-4c9c-909e-0ee4b2c26257}"}, "links": {"attachments": {"href": "data/repositories/hoffmanlab/segway/issues/18/attachments_page=1.json"}, "self": {"href": "data/repositories/hoffmanlab/segway/issues/18.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/issues/18/watch"}, "comments": {"href": "data/repositories/hoffmanlab/segway/issues/18/comments_page=1.json"}, "html": {"href": "#!/hoffmanlab/segway/issues/18/divide-by-zero-error-when-num-sublabels-is"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/issues/18/vote"}}, "reporter": {"display_name": "ajshaw", "uuid": "{547650d6-1225-4731-b1da-ba9913babfbf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B547650d6-1225-4731-b1da-ba9913babfbf%7D"}, "html": {"href": "https://bitbucket.org/%7B547650d6-1225-4731-b1da-ba9913babfbf%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1f9b227ab720d7a41f4f0d49570db03fd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsA-2.png"}}, "nickname": "ajshaw", "type": "user", "account_id": "5b22d060ba383e0814004a64"}, "title": "Divide-by-zero error when num-sublabels is set to 0", "component": null, "votes": 0, "watches": 2, "content": {"raw": "Setting num-sublabels to 1 is what disables hierarchical segmentation and sets it to 1 sublabel per label, but setting num-sublabels to 0 is not safely accounted for, and results in a divide-by-zero error. If this is a setting that doesn't make sense, then it would be better if it triggered a helpful error message.\r\n\r\nSteps to reproduce: segway train --num-sublabels=0\r\n\r\nResult:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/mnt/work1/users/home2/ashaw/bin/segway\", line 9, in <module>\r\n    load_entry_point('segway==1.2.0.dev-rel889-hga69ed44ef8c8p', 'console_scripts', 'segway')()\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py\", line 2537, in main\r\n    return runner()\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py\", line 2359, in __call__\r\n    self.run(*args, **kwargs)\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py\", line 2333, in run\r\n    self.run_train()\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py\", line 1915, in run_train\r\n    dst_filenames = self.setup_train()\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py\", line 1878, in setup_train\r\n    self.params_dirpath, self.clobber)\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/_util.py\", line 150, in __call__\r\n    *args, **kwargs)\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/_util.py\", line 452, in save_template\r\n    save_substituted_resource(filename, resource, mapping)\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/_util.py\", line 435, in save_substituted_resource\r\n    text = tmpl.substitute(mapping)\r\n  File \"/mnt/work1/software/python/2.7/lib/python2.7/string.py\", line 172, in substitute\r\n    return self.pattern.sub(convert, self.template)\r\n  File \"/mnt/work1/software/python/2.7/lib/python2.7/string.py\", line 165, in convert\r\n    return '%s' % (val,)\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/input_master.py\", line 236, in __str__\r\n    return make_spec(self.type_name, self.generate_objects())\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/input_master.py\", line 79, in make_spec\r\n    items = list(iterable)\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/input_master.py\", line 446, in generate_objects\r\n    yield self.make_dense_cpt_seg_subseg_spec()\r\n  File \"/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/input_master.py\", line 338, in make_dense_cpt_seg_subseg_spec\r\n    cpt = fill_array(1.0 / num_subsegs, (self.num_segs, num_subsegs))\r\nZeroDivisionError: float division by zero\r\n```", "markup": "markdown", "html": "<p>Setting num-sublabels to 1 is what disables hierarchical segmentation and sets it to 1 sublabel per label, but setting num-sublabels to 0 is not safely accounted for, and results in a divide-by-zero error. If this is a setting that doesn't make sense, then it would be better if it triggered a helpful error message.</p>\n<p>Steps to reproduce: segway train --num-sublabels=0</p>\n<p>Result:</p>\n<div class=\"codehilite\"><pre><span></span>Traceback (most recent call last):\n  File &quot;/mnt/work1/users/home2/ashaw/bin/segway&quot;, line 9, in &lt;module&gt;\n    load_entry_point(&#39;segway==1.2.0.dev-rel889-hga69ed44ef8c8p&#39;, &#39;console_scripts&#39;, &#39;segway&#39;)()\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py&quot;, line 2537, in main\n    return runner()\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py&quot;, line 2359, in __call__\n    self.run(*args, **kwargs)\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py&quot;, line 2333, in run\n    self.run_train()\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py&quot;, line 1915, in run_train\n    dst_filenames = self.setup_train()\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/run.py&quot;, line 1878, in setup_train\n    self.params_dirpath, self.clobber)\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/_util.py&quot;, line 150, in __call__\n    *args, **kwargs)\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/_util.py&quot;, line 452, in save_template\n    save_substituted_resource(filename, resource, mapping)\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/_util.py&quot;, line 435, in save_substituted_resource\n    text = tmpl.substitute(mapping)\n  File &quot;/mnt/work1/software/python/2.7/lib/python2.7/string.py&quot;, line 172, in substitute\n    return self.pattern.sub(convert, self.template)\n  File &quot;/mnt/work1/software/python/2.7/lib/python2.7/string.py&quot;, line 165, in convert\n    return &#39;%s&#39; % (val,)\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/input_master.py&quot;, line 236, in __str__\n    return make_spec(self.type_name, self.generate_objects())\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/input_master.py&quot;, line 79, in make_spec\n    items = list(iterable)\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/input_master.py&quot;, line 446, in generate_objects\n    yield self.make_dense_cpt_seg_subseg_spec()\n  File &quot;/mnt/work1/users/home2/ashaw/bin/lib/python2.7/site-packages/segway-1.2.0.dev_rel889_hga69ed44ef8c8p-py2.7.egg/segway/input_master.py&quot;, line 338, in make_dense_cpt_seg_subseg_spec\n    cpt = fill_array(1.0 / num_subsegs, (self.num_segs, num_subsegs))\nZeroDivisionError: float division by zero\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "new", "version": null, "edited_on": null, "created_on": "2014-08-07T15:12:09.466048+00:00", "milestone": null, "updated_on": "2014-08-07T15:14:39.454720+00:00", "type": "issue", "id": 18}
{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/hoffmanlab/segway.json"}, "html": {"href": "#!/hoffmanlab/segway"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68bf38bf-f0c1-4c9c-909e-0ee4b2c26257}ts=python"}}, "type": "repository", "name": "segway", "full_name": "hoffmanlab/segway", "uuid": "{68bf38bf-f0c1-4c9c-909e-0ee4b2c26257}"}, "links": {"attachments": {"href": "data/repositories/hoffmanlab/segway/issues/22/attachments_page=1.json"}, "self": {"href": "data/repositories/hoffmanlab/segway/issues/22.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/issues/22/watch"}, "comments": {"href": "data/repositories/hoffmanlab/segway/issues/22/comments_page=1.json"}, "html": {"href": "#!/hoffmanlab/segway/issues/22/segway-layer-bigbed-conversion-fails-when"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/issues/22/vote"}}, "reporter": {"display_name": "Jay Hesselberth", "uuid": "{ba6c3099-0fad-4fe3-8aac-9429e99631c1}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bba6c3099-0fad-4fe3-8aac-9429e99631c1%7D"}, "html": {"href": "https://bitbucket.org/%7Bba6c3099-0fad-4fe3-8aac-9429e99631c1%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/049cb0ae5e8c23023c2e48b92a391744d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJH-6.png"}}, "nickname": "jayhesselberth", "type": "user", "account_id": "557058:b5b61d92-1c2c-4bff-8c23-3d28f323ab21"}, "title": "segway-layer bigBed conversion fails when blockSize == 0", "component": null, "votes": 0, "watches": 3, "content": {"raw": "bigBed conversion is failing in `segway-layer`, it appears this is because the blockSizes begin with 0 instead of 1.  Here's an example from within the simpleseg test:\r\n\r\n\r\n```\r\n#!python\r\n\r\njayhesselberth@urburp ~/devel/segway/test/simpleseg/test-20141020.VYnG8M/identifydir\r\n$ segway-layer -b segway.layered.bb segway.bed.gz \r\ntrack autoScale=off description=\"segway 4-label segmentation of testtrack1, testtrack2\" viewLimits=0:1 visibility=full name=segway.034364de589011e4ac68542696df0d9d itemRgb=on\r\n\r\nchr1\t0\t8000\t1\t1000\t.\t0\t8000\t217,95,2\t3\t2000,2000,1\t0,4000,7999\r\nchr1\t0\t8000\t2\t1000\t.\t0\t8000\t117,112,179\t4\t0,1000,1000,1\t0,2000,6000,7999\r\nchr1\t0\t8000\t3\t1000\t.\t0\t8000\t231,41,138\t3\t0,1000,1000\t0,3000,7000\r\npass1 - making usageList (1 chroms): 0 millis\r\nError line 2 of /var/folders/s5/dh_w3yds5qx9gl409s178_qw0000gn/T/segway2UkENz.bed: BED blockSizes must be greater than 0, blockSize[0] = 0\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/segway-layer\", line 9, in <module>\r\n    load_entry_point('segway==1.2', 'console_scripts', 'segway-layer')()\r\n  File \"/usr/local/lib/python2.7/site-packages/segway/layer.py\", line 393, in main\r\n    *args)\r\n  File \"/usr/local/lib/python2.7/site-packages/segway/layer.py\", line 358, in layer\r\n    segmentation.save(outfilename, bigbed_outfilename)\r\n  File \"/usr/local/lib/python2.7/site-packages/segway/layer.py\", line 270, in save\r\n    BEDTOBIGBED_PROG(bigbed_infilename, sizes_file.name, bigbed_outfilename)\r\n  File \"/usr/local/lib/python2.7/site-packages/segway/layer.py\", line 270, in save\r\n    BEDTOBIGBED_PROG(bigbed_infilename, sizes_file.name, bigbed_outfilename)\r\n  File \"/usr/local/lib/python2.7/site-packages/optbuild.py\", line 81, in __call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/site-packages/optbuild.py\", line 212, in run\r\n    self._getoutput(args, kwargs)\r\n  File \"/usr/local/lib/python2.7/site-packages/optbuild.py\", line 194, in _getoutput\r\n    stdin, stdout, stderr, cwd)\r\n  File \"/usr/local/lib/python2.7/site-packages/optbuild.py\", line 157, in _popen\r\n    _returncode_error_factory(cmdline, returncode, output, error)\r\n  File \"/usr/local/lib/python2.7/site-packages/optbuild.py\", line 57, in _returncode_error_factory\r\n    raise error_cls, (cmdline, returncode, output, error)\r\noptbuild.ReturncodeError: bedToBigBed returned 255\r\n\r\n```\r\n", "markup": "markdown", "html": "<p>bigBed conversion is failing in <code>segway-layer</code>, it appears this is because the blockSizes begin with 0 instead of 1.  Here's an example from within the simpleseg test:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">jayhesselberth</span><span class=\"nd\">@urburp</span> <span class=\"o\">~/</span><span class=\"n\">devel</span><span class=\"o\">/</span><span class=\"n\">segway</span><span class=\"o\">/</span><span class=\"n\">test</span><span class=\"o\">/</span><span class=\"n\">simpleseg</span><span class=\"o\">/</span><span class=\"n\">test</span><span class=\"o\">-</span><span class=\"mf\">20141020.</span><span class=\"n\">VYnG8M</span><span class=\"o\">/</span><span class=\"n\">identifydir</span>\n<span class=\"err\">$</span> <span class=\"n\">segway</span><span class=\"o\">-</span><span class=\"n\">layer</span> <span class=\"o\">-</span><span class=\"n\">b</span> <span class=\"n\">segway</span><span class=\"o\">.</span><span class=\"n\">layered</span><span class=\"o\">.</span><span class=\"n\">bb</span> <span class=\"n\">segway</span><span class=\"o\">.</span><span class=\"n\">bed</span><span class=\"o\">.</span><span class=\"n\">gz</span> \n<span class=\"n\">track</span> <span class=\"n\">autoScale</span><span class=\"o\">=</span><span class=\"n\">off</span> <span class=\"n\">description</span><span class=\"o\">=</span><span class=\"s2\">&quot;segway 4-label segmentation of testtrack1, testtrack2&quot;</span> <span class=\"n\">viewLimits</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"mi\">1</span> <span class=\"n\">visibility</span><span class=\"o\">=</span><span class=\"n\">full</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">segway</span><span class=\"o\">.</span><span class=\"mo\">034364</span><span class=\"n\">de589011e4ac68542696df0d9d</span> <span class=\"n\">itemRgb</span><span class=\"o\">=</span><span class=\"n\">on</span>\n\n<span class=\"n\">chr1</span>    <span class=\"mi\">0</span>   <span class=\"mi\">8000</span>    <span class=\"mi\">1</span>   <span class=\"mi\">1000</span>    <span class=\"o\">.</span>   <span class=\"mi\">0</span>   <span class=\"mi\">8000</span>    <span class=\"mi\">217</span><span class=\"p\">,</span><span class=\"mi\">95</span><span class=\"p\">,</span><span class=\"mi\">2</span>    <span class=\"mi\">3</span>   <span class=\"mi\">2000</span><span class=\"p\">,</span><span class=\"mi\">2000</span><span class=\"p\">,</span><span class=\"mi\">1</span> <span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">4000</span><span class=\"p\">,</span><span class=\"mi\">7999</span>\n<span class=\"n\">chr1</span>    <span class=\"mi\">0</span>   <span class=\"mi\">8000</span>    <span class=\"mi\">2</span>   <span class=\"mi\">1000</span>    <span class=\"o\">.</span>   <span class=\"mi\">0</span>   <span class=\"mi\">8000</span>    <span class=\"mi\">117</span><span class=\"p\">,</span><span class=\"mi\">112</span><span class=\"p\">,</span><span class=\"mi\">179</span> <span class=\"mi\">4</span>   <span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">1000</span><span class=\"p\">,</span><span class=\"mi\">1000</span><span class=\"p\">,</span><span class=\"mi\">1</span>   <span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">2000</span><span class=\"p\">,</span><span class=\"mi\">6000</span><span class=\"p\">,</span><span class=\"mi\">7999</span>\n<span class=\"n\">chr1</span>    <span class=\"mi\">0</span>   <span class=\"mi\">8000</span>    <span class=\"mi\">3</span>   <span class=\"mi\">1000</span>    <span class=\"o\">.</span>   <span class=\"mi\">0</span>   <span class=\"mi\">8000</span>    <span class=\"mi\">231</span><span class=\"p\">,</span><span class=\"mi\">41</span><span class=\"p\">,</span><span class=\"mi\">138</span>  <span class=\"mi\">3</span>   <span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">1000</span><span class=\"p\">,</span><span class=\"mi\">1000</span> <span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">3000</span><span class=\"p\">,</span><span class=\"mi\">7000</span>\n<span class=\"n\">pass1</span> <span class=\"o\">-</span> <span class=\"n\">making</span> <span class=\"n\">usageList</span> <span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"n\">chroms</span><span class=\"p\">):</span> <span class=\"mi\">0</span> <span class=\"n\">millis</span>\n<span class=\"n\">Error</span> <span class=\"n\">line</span> <span class=\"mi\">2</span> <span class=\"n\">of</span> <span class=\"o\">/</span><span class=\"n\">var</span><span class=\"o\">/</span><span class=\"n\">folders</span><span class=\"o\">/</span><span class=\"n\">s5</span><span class=\"o\">/</span><span class=\"n\">dh_w3yds5qx9gl409s178_qw0000gn</span><span class=\"o\">/</span><span class=\"n\">T</span><span class=\"o\">/</span><span class=\"n\">segway2UkENz</span><span class=\"o\">.</span><span class=\"n\">bed</span><span class=\"p\">:</span> <span class=\"n\">BED</span> <span class=\"n\">blockSizes</span> <span class=\"n\">must</span> <span class=\"n\">be</span> <span class=\"n\">greater</span> <span class=\"n\">than</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">blockSize</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/bin/segway-layer&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"n\">load_entry_point</span><span class=\"p\">(</span><span class=\"s1\">&#39;segway==1.2&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;console_scripts&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;segway-layer&#39;</span><span class=\"p\">)()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/site-packages/segway/layer.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">393</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">main</span>\n    <span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/site-packages/segway/layer.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">358</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">layer</span>\n    <span class=\"n\">segmentation</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">(</span><span class=\"n\">outfilename</span><span class=\"p\">,</span> <span class=\"n\">bigbed_outfilename</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/site-packages/segway/layer.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">270</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">save</span>\n    <span class=\"n\">BEDTOBIGBED_PROG</span><span class=\"p\">(</span><span class=\"n\">bigbed_infilename</span><span class=\"p\">,</span> <span class=\"n\">sizes_file</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">bigbed_outfilename</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/site-packages/segway/layer.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">270</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">save</span>\n    <span class=\"n\">BEDTOBIGBED_PROG</span><span class=\"p\">(</span><span class=\"n\">bigbed_infilename</span><span class=\"p\">,</span> <span class=\"n\">sizes_file</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">bigbed_outfilename</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/site-packages/optbuild.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">81</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"fm\">__call__</span>\n    <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/site-packages/optbuild.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">212</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_getoutput</span><span class=\"p\">(</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/site-packages/optbuild.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">194</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_getoutput</span>\n    <span class=\"n\">stdin</span><span class=\"p\">,</span> <span class=\"n\">stdout</span><span class=\"p\">,</span> <span class=\"n\">stderr</span><span class=\"p\">,</span> <span class=\"n\">cwd</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/site-packages/optbuild.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">157</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_popen</span>\n    <span class=\"n\">_returncode_error_factory</span><span class=\"p\">(</span><span class=\"n\">cmdline</span><span class=\"p\">,</span> <span class=\"n\">returncode</span><span class=\"p\">,</span> <span class=\"n\">output</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/site-packages/optbuild.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">57</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_returncode_error_factory</span>\n    <span class=\"k\">raise</span> <span class=\"n\">error_cls</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">cmdline</span><span class=\"p\">,</span> <span class=\"n\">returncode</span><span class=\"p\">,</span> <span class=\"n\">output</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"p\">)</span>\n<span class=\"n\">optbuild</span><span class=\"o\">.</span><span class=\"n\">ReturncodeError</span><span class=\"p\">:</span> <span class=\"n\">bedToBigBed</span> <span class=\"n\">returned</span> <span class=\"mi\">255</span>\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "resolved", "version": null, "edited_on": null, "created_on": "2014-10-20T19:56:22.102876+00:00", "milestone": null, "updated_on": "2014-11-11T16:27:55.670281+00:00", "type": "issue", "id": 22}
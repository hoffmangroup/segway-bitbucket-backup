{"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/89/comments/70230218.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/mjmm13/segway_python23:c48413d9bb0d..50c798f683cf?path=segway%2Finput_master.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/89/_/diff#comment-70230218"}}, "parent": {"id": 69946815, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/89/comments/69946815.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/89/_/diff#comment-69946815"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 89, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/89.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/89"}}, "title": "Python 3 Compatibility"}, "content": {"raw": "After a lot of investigation and discussion there\u2019s a few things to consider:\n\n* ParamSpec \\(and it's children\\) may need to be reused with string interpolation included \\(calls to `__str__` method\\). The user of ParamSpec probably does not expect that it's `__str__` will be called twice.\n* This only happens in Python 2 when a unicode string is returned by the `__str__` method\n\nSo I think there\u2019s two okay solutions to this:\n\n1. Find out why the child ParamSpec \\(e.g. MeanParamSpec\\) is returning a unicode string from `generate_objects` in Python 2, and if possible, change to return vanilla Python 2 \\(non-unicode\\) strings.\n2. Add a conditional in ParamSpec's `__str__` method, checking something like `six.PY2` \\(if we're using Python 2\\) and force a return of an `.encode('ascii')` of the string to to be returned \\(which is a little more future-proof but may hide underlying code issues from #1\\).\n\n", "markup": "markdown", "html": "<p>After a lot of investigation and discussion there\u2019s a few things to consider:</p>\n<ul>\n<li>ParamSpec (and it's children) may need to be reused with string interpolation included (calls to <code>__str__</code> method). The user of ParamSpec probably does not expect that it's <code>__str__</code> will be called twice.</li>\n<li>This only happens in Python 2 when a unicode string is returned by the <code>__str__</code> method</li>\n</ul>\n<p>So I think there\u2019s two okay solutions to this:</p>\n<ol>\n<li>Find out why the child ParamSpec (e.g. MeanParamSpec) is returning a unicode string from <code>generate_objects</code> in Python 2, and if possible, change to return vanilla Python 2 (non-unicode) strings.</li>\n<li>Add a conditional in ParamSpec's <code>__str__</code> method, checking something like <code>six.PY2</code> (if we're using Python 2) and force a return of an <code>.encode('ascii')</code> of the string to to be returned (which is a little more future-proof but may hide underlying code issues from <a href=\"#!/hoffmanlab/segway/issues/1/error-creating-inputmaster\" rel=\"nofollow\" title=\"Error creating input.master\" class=\"ap-connect-link\"><s>#1</s></a>).</li>\n</ol>", "type": "rendered"}, "created_on": "2018-07-17T20:00:07.376734+00:00", "user": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "inline": {"to": null, "from": null, "outdated": true, "path": "segway/input_master.py"}, "updated_on": "2018-07-17T20:00:07.394970+00:00", "type": "pullrequest_comment", "id": 70230218}
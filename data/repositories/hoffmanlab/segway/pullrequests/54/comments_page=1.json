{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19560364.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19560364"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "Are there any other objects that have an instance of a JobTemplateFactory as an instance? As-in are there different objects representing jobs other than RestartableJob? Those objects would also need to call the `deleteJobTemplate` method of the JobTemplateFactory when those objects are \"deleted\" as well.", "markup": "markdown", "html": "<p>Are there any other objects that have an instance of a JobTemplateFactory as an instance? As-in are there different objects representing jobs other than RestartableJob? Those objects would also need to call the <code>deleteJobTemplate</code> method of the JobTemplateFactory when those objects are \"deleted\" as well.</p>", "type": "rendered"}, "created_on": "2016-06-09T15:36:01.184442+00:00", "user": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "updated_on": "2016-06-09T15:36:51.943979+00:00", "type": "pullrequest_comment", "id": 19560364}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19561388.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19561388"}}, "parent": {"id": 19560364, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19560364.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19560364"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "Upon searching, I found that the only instantiation of the JobTemplateFactory object is for job_tmpl_factory (line 1897 of ```run.py```), which is then used to create a RestartableJob to be added to RestartableJobDict. There are no other instantiations. The job_tmpl_factory object created is also only put into the RestartableJob object (line 1911 of ```run.py```), no other objects.", "markup": "markdown", "html": "<p>Upon searching, I found that the only instantiation of the JobTemplateFactory object is for job_tmpl_factory (line 1897 of <code>run.py</code>), which is then used to create a RestartableJob to be added to RestartableJobDict. There are no other instantiations. The job_tmpl_factory object created is also only put into the RestartableJob object (line 1911 of <code>run.py</code>), no other objects.</p>", "type": "rendered"}, "created_on": "2016-06-09T15:49:58.481292+00:00", "user": {"display_name": "Rachel Chan", "uuid": "{20430f8d-4e6b-48cc-a8d8-c64868bf7e79}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D"}, "html": {"href": "https://bitbucket.org/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/4397abec9f84e35f1f235b350984833dd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRC-1.png"}}, "nickname": "rcwchan", "type": "user", "account_id": "557058:e439e22e-8cfc-4cf1-b090-030d33a0730e"}, "updated_on": "2016-06-09T15:49:58.488698+00:00", "type": "pullrequest_comment", "id": 19561388}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19560456.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19560456"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "Please add this to the NEWS", "markup": "markdown", "html": "<p>Please add this to the NEWS</p>", "type": "rendered"}, "created_on": "2016-06-09T15:37:09.553132+00:00", "user": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "updated_on": "2016-06-09T15:37:09.558961+00:00", "type": "pullrequest_comment", "id": 19560456}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19561693.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19561693"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "It indeed seems to fix the memory leak found in issue 60: \n\nGraph of resident set size (kB) vs Time (2s timesteps) over 19 hours, with job template deletion:\n\n![image.png](data/bitbucket.org/repo/a7MnLo/images/870538536-image.png)\n\nGraph of resident set size (kB) vs Time (2s timesteps) over just 2.5 hours, without job template deletion:\n\n![imagecontrol.png](data/bitbucket.org/repo/a7MnLo/images/3718677290-imagecontrol.png)", "markup": "markdown", "html": "<p>It indeed seems to fix the memory leak found in issue 60: </p>\n<p>Graph of resident set size (kB) vs Time (2s timesteps) over 19 hours, with job template deletion:</p>\n<p><img alt=\"image.png\" src=\"data/bitbucket.org/repo/a7MnLo/images/870538536-image.png\" /></p>\n<p>Graph of resident set size (kB) vs Time (2s timesteps) over just 2.5 hours, without job template deletion:</p>\n<p><img alt=\"imagecontrol.png\" src=\"data/bitbucket.org/repo/a7MnLo/images/3718677290-imagecontrol.png\" /></p>", "type": "rendered"}, "created_on": "2016-06-09T15:53:55.916223+00:00", "user": {"display_name": "Rachel Chan", "uuid": "{20430f8d-4e6b-48cc-a8d8-c64868bf7e79}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D"}, "html": {"href": "https://bitbucket.org/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/4397abec9f84e35f1f235b350984833dd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRC-1.png"}}, "nickname": "rcwchan", "type": "user", "account_id": "557058:e439e22e-8cfc-4cf1-b090-030d33a0730e"}, "updated_on": "2016-06-09T15:54:19.801190+00:00", "type": "pullrequest_comment", "id": 19561693}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19562365.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19562365"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "@hoffman this is ready for your review", "markup": "markdown", "html": "<p>@hoffman this is ready for your review</p>", "type": "rendered"}, "created_on": "2016-06-09T16:03:21.042495+00:00", "user": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "updated_on": "2016-06-09T16:03:21.055958+00:00", "type": "pullrequest_comment", "id": 19562365}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19804429.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:cdfc63bb9fea..02c1669515d6?path=segway%2Fcluster%2Fcommon.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19804429"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "Please rewrite this in PEP 8 style i.e. `delete_job_template()`.\n\nAlso please add a comment explaining why this is in here even though it is not really a typical \"factory\" method. (I presume it is because you want to be able to override this for some cluster system.)", "markup": "markdown", "html": "<p>Please rewrite this in PEP 8 style i.e. <code>delete_job_template()</code>.</p>\n<p>Also please add a comment explaining why this is in here even though it is not really a typical \"factory\" method. (I presume it is because you want to be able to override this for some cluster system.)</p>", "type": "rendered"}, "created_on": "2016-06-15T17:27:10.055560+00:00", "user": {"display_name": "Michael Hoffman", "uuid": "{ffa8e039-5d4d-4f69-a4ba-ac25cbaf700b}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bffa8e039-5d4d-4f69-a4ba-ac25cbaf700b%7D"}, "html": {"href": "https://bitbucket.org/%7Bffa8e039-5d4d-4f69-a4ba-ac25cbaf700b%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/6a95e857a02504cbad5fe965c9d9e4bbd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMH-1.png"}}, "nickname": "hoffman", "type": "user", "account_id": "557058:a9657985-692c-405c-995b-4e41cda7ba2b"}, "inline": {"to": 114, "from": null, "path": "segway/cluster/common.py"}, "updated_on": "2016-06-15T17:27:10.060932+00:00", "type": "pullrequest_comment", "id": 19804429}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19973851.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:None..None?path=segway%2Fcluster%2Fcommon.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19973851"}}, "parent": {"id": 19804429, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19804429.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19804429"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "We chose to place this function here (within _JobTemplateFactory) since JobTemplateFactory should probably delete its own job template object (rather than RestartableJob deleting it for JobTemplateFactory). So what currently happens is that upon 0 references of Restartable Job, RestartableJob tells JobTemplateFactory that its job template is no longer needed and should be deleted. The alternative is to directly delete the job template from JobTemplateFactory from within RestartableJob.", "markup": "markdown", "html": "<p>We chose to place this function here (within _JobTemplateFactory) since JobTemplateFactory should probably delete its own job template object (rather than RestartableJob deleting it for JobTemplateFactory). So what currently happens is that upon 0 references of Restartable Job, RestartableJob tells JobTemplateFactory that its job template is no longer needed and should be deleted. The alternative is to directly delete the job template from JobTemplateFactory from within RestartableJob.</p>", "type": "rendered"}, "created_on": "2016-06-20T15:30:31.667762+00:00", "user": {"display_name": "Rachel Chan", "uuid": "{20430f8d-4e6b-48cc-a8d8-c64868bf7e79}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D"}, "html": {"href": "https://bitbucket.org/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/4397abec9f84e35f1f235b350984833dd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRC-1.png"}}, "nickname": "rcwchan", "type": "user", "account_id": "557058:e439e22e-8cfc-4cf1-b090-030d33a0730e"}, "inline": {"to": null, "from": null, "path": "segway/cluster/common.py"}, "updated_on": "2016-06-20T15:43:23.923099+00:00", "type": "pullrequest_comment", "id": 19973851}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19804624.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:cdfc63bb9fea..02c1669515d6?path=segway%2Fcluster%2F__init__.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19804624"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "How does this work in local mode? There's no `segway.cluster.local.Session.deleteJobTemplate()`.\n\n`__del__()` is not guaranteed to be called.", "markup": "markdown", "html": "<p>How does this work in local mode? There's no <code>segway.cluster.local.Session.deleteJobTemplate()</code>.</p>\n<p><code>__del__()</code> is not guaranteed to be called.</p>", "type": "rendered"}, "created_on": "2016-06-15T17:30:54.921289+00:00", "user": {"display_name": "Michael Hoffman", "uuid": "{ffa8e039-5d4d-4f69-a4ba-ac25cbaf700b}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bffa8e039-5d4d-4f69-a4ba-ac25cbaf700b%7D"}, "html": {"href": "https://bitbucket.org/%7Bffa8e039-5d4d-4f69-a4ba-ac25cbaf700b%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/6a95e857a02504cbad5fe965c9d9e4bbd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMH-1.png"}}, "nickname": "hoffman", "type": "user", "account_id": "557058:a9657985-692c-405c-995b-4e41cda7ba2b"}, "inline": {"to": 151, "from": null, "path": "segway/cluster/__init__.py"}, "updated_on": "2016-06-15T17:30:54.923320+00:00", "type": "pullrequest_comment", "id": 19804624}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19808997.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:None..None?path=segway%2Fcluster%2F__init__.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19808997"}}, "parent": {"id": 19804624, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19804624.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19804624"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "See the language reference for [`object.__del__()`](https://docs.python.org/2/reference/datamodel.html#object.__del__).", "markup": "markdown", "html": "<p>See the language reference for <a data-is-external-link=\"true\" href=\"https://docs.python.org/2/reference/datamodel.html#object.__del__\" rel=\"nofollow\"><code>object.__del__()</code></a>.</p>", "type": "rendered"}, "created_on": "2016-06-15T19:01:54.263994+00:00", "user": {"display_name": "Michael Hoffman", "uuid": "{ffa8e039-5d4d-4f69-a4ba-ac25cbaf700b}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bffa8e039-5d4d-4f69-a4ba-ac25cbaf700b%7D"}, "html": {"href": "https://bitbucket.org/%7Bffa8e039-5d4d-4f69-a4ba-ac25cbaf700b%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/6a95e857a02504cbad5fe965c9d9e4bbd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMH-1.png"}}, "nickname": "hoffman", "type": "user", "account_id": "557058:a9657985-692c-405c-995b-4e41cda7ba2b"}, "inline": {"to": null, "from": null, "path": "segway/cluster/__init__.py"}, "updated_on": "2016-06-15T19:02:35.584127+00:00", "type": "pullrequest_comment", "id": 19808997}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19972925.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:None..None?path=segway%2Fcluster%2F__init__.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19972925"}}, "parent": {"id": 19808997, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/19808997.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-19808997"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "According to the documentation linked, ```RestartableJob.__del__()``` would only be called when the reference count of RestartableJob drops to 0, which is what we want (since RestartableJob is the only object that holds JobTemplateFactory, which is the only object that holds the job template). I don't think there would be a case where we would like to delete the job template even if there are other references to RestartableJob (though there shouldn't be). \n\nAlso, I tested on mordor and double deletion of a job template calls a double free, which results in a segfault (which can't be caught the same way as an exception).", "markup": "markdown", "html": "<p>According to the documentation linked, <code>RestartableJob.__del__()</code> would only be called when the reference count of RestartableJob drops to 0, which is what we want (since RestartableJob is the only object that holds JobTemplateFactory, which is the only object that holds the job template). I don't think there would be a case where we would like to delete the job template even if there are other references to RestartableJob (though there shouldn't be). </p>\n<p>Also, I tested on mordor and double deletion of a job template calls a double free, which results in a segfault (which can't be caught the same way as an exception).</p>", "type": "rendered"}, "created_on": "2016-06-20T15:15:45.873320+00:00", "user": {"display_name": "Rachel Chan", "uuid": "{20430f8d-4e6b-48cc-a8d8-c64868bf7e79}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D"}, "html": {"href": "https://bitbucket.org/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/4397abec9f84e35f1f235b350984833dd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRC-1.png"}}, "nickname": "rcwchan", "type": "user", "account_id": "557058:e439e22e-8cfc-4cf1-b090-030d33a0730e"}, "inline": {"to": null, "from": null, "path": "segway/cluster/__init__.py"}, "updated_on": "2016-06-20T17:38:34.411075+00:00", "type": "pullrequest_comment", "id": 19972925}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/20109952.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:8bb520140521..02c1669515d6?path=segway%2Fcluster%2Fcommon.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-20109952"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "This comment should probably be placed in the RestartableJob portion. This method should be agnostic to what RestartableJob is doing.", "markup": "markdown", "html": "<p>This comment should probably be placed in the RestartableJob portion. This method should be agnostic to what RestartableJob is doing.</p>", "type": "rendered"}, "created_on": "2016-06-22T19:24:46.232927+00:00", "user": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "inline": {"to": 115, "from": null, "path": "segway/cluster/common.py"}, "updated_on": "2016-06-22T19:24:46.237903+00:00", "type": "pullrequest_comment", "id": 20109952}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/20117135.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:6b2199aaa4ae..02c1669515d6?path=segway%2Fcluster%2F__init__.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-20117135"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "This passed all the simple* tests both locally and on mordor, but I decided to try it out with a larger run just in case. Just got this error:\n\n```\n207 critical error: error: lGetElemStr(Nameindex = 1400): run time type error\n208 Exception in thread Thread-1:\n209 Traceback (most recent call last):\n210   File \"/mnt/work1/software/python/2.7/lib/python2.7/threading.py\", line 551, in __bootstrap_inner\n211     self.run()\n212   File \"/mnt/work1/users/home2/rachelc/segway/segway/run.py\", line 438, in run\n213     self.result = self.runner.run_train_instance()\n214   File \"/mnt/work1/users/home2/rachelc/segway/segway/run.py\", line 2133, in run_train_instance\n215     round_index, kwargs)\n216   File \"/mnt/work1/users/home2/rachelc/segway/segway/run.py\", line 2140, in progress_train_instance\n217     self.run_train_round(self.instance_index, round_index, **kwargs)\n218   File \"/mnt/work1/users/home2/rachelc/segway/segway/run.py\", line 2092, in run_train_round\n219     restartable_jobs.wait()\n220   File \"/mnt/work1/users/home2/rachelc/segway/segway/cluster/__init__.py\", line 292, in wait\n221     self.process_job(jobid, job_info)\n222   File \"/mnt/work1/users/home2/rachelc/segway/segway/cluster/__init__.py\", line 254, in process_job\n223     jobname = restartable_job.job_tmpl_factory.template.jobName\n224   File \"/mnt/work1/users/home2/rachelc/.local/lib/python2.7/site-packages/drmaa/helpers.py\", line 159, in __get__\n225     sizeof(attr_buffer))\n226   File \"/mnt/work1/users/home2/rachelc/.local/lib/python2.7/site-packages/drmaa/helpers.py\", line 299, in c\n227     return f(*(args + (error_buffer, sizeof(error_buffer))))\n228   File \"/mnt/work1/users/home2/rachelc/.local/lib/python2.7/site-packages/drmaa/errors.py\", line 151, in error_check\n229     raise _ERRORS[code - 1](error_string)\n230 InvalidAttributeValueException: code 14: The value for the job attribute is invalid.\n```\n\nthink it might be because the job template is being deleted before all references to the RestartableJob are gone. However, there doesn't seem to be any other place in the code where the RestartableJob is deleted explicitly, so I don't know where I would put this function call. @ericr86 , where do you think would be a good place to call this?\n\nEDIT: can confirm error is caused by premature template deletion; errors (same error appears multiple times) go away after reverting back to using the ```__del__``` function.", "markup": "markdown", "html": "<p>This passed all the simple* tests both locally and on mordor, but I decided to try it out with a larger run just in case. Just got this error:</p>\n<div class=\"codehilite\"><pre><span></span>207 critical error: error: lGetElemStr(Nameindex = 1400): run time type error\n208 Exception in thread Thread-1:\n209 Traceback (most recent call last):\n210   File &quot;/mnt/work1/software/python/2.7/lib/python2.7/threading.py&quot;, line 551, in __bootstrap_inner\n211     self.run()\n212   File &quot;/mnt/work1/users/home2/rachelc/segway/segway/run.py&quot;, line 438, in run\n213     self.result = self.runner.run_train_instance()\n214   File &quot;/mnt/work1/users/home2/rachelc/segway/segway/run.py&quot;, line 2133, in run_train_instance\n215     round_index, kwargs)\n216   File &quot;/mnt/work1/users/home2/rachelc/segway/segway/run.py&quot;, line 2140, in progress_train_instance\n217     self.run_train_round(self.instance_index, round_index, **kwargs)\n218   File &quot;/mnt/work1/users/home2/rachelc/segway/segway/run.py&quot;, line 2092, in run_train_round\n219     restartable_jobs.wait()\n220   File &quot;/mnt/work1/users/home2/rachelc/segway/segway/cluster/__init__.py&quot;, line 292, in wait\n221     self.process_job(jobid, job_info)\n222   File &quot;/mnt/work1/users/home2/rachelc/segway/segway/cluster/__init__.py&quot;, line 254, in process_job\n223     jobname = restartable_job.job_tmpl_factory.template.jobName\n224   File &quot;/mnt/work1/users/home2/rachelc/.local/lib/python2.7/site-packages/drmaa/helpers.py&quot;, line 159, in __get__\n225     sizeof(attr_buffer))\n226   File &quot;/mnt/work1/users/home2/rachelc/.local/lib/python2.7/site-packages/drmaa/helpers.py&quot;, line 299, in c\n227     return f(*(args + (error_buffer, sizeof(error_buffer))))\n228   File &quot;/mnt/work1/users/home2/rachelc/.local/lib/python2.7/site-packages/drmaa/errors.py&quot;, line 151, in error_check\n229     raise _ERRORS[code - 1](error_string)\n230 InvalidAttributeValueException: code 14: The value for the job attribute is invalid.\n</pre></div>\n\n\n<p>think it might be because the job template is being deleted before all references to the RestartableJob are gone. However, there doesn't seem to be any other place in the code where the RestartableJob is deleted explicitly, so I don't know where I would put this function call. @ericr86 , where do you think would be a good place to call this?</p>\n<p>EDIT: can confirm error is caused by premature template deletion; errors (same error appears multiple times) go away after reverting back to using the <code>__del__</code> function.</p>", "type": "rendered"}, "created_on": "2016-06-22T22:02:38.893282+00:00", "user": {"display_name": "Rachel Chan", "uuid": "{20430f8d-4e6b-48cc-a8d8-c64868bf7e79}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D"}, "html": {"href": "https://bitbucket.org/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/4397abec9f84e35f1f235b350984833dd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRC-1.png"}}, "nickname": "rcwchan", "type": "user", "account_id": "557058:e439e22e-8cfc-4cf1-b090-030d33a0730e"}, "inline": {"to": 274, "from": null, "path": "segway/cluster/__init__.py"}, "updated_on": "2016-06-22T22:20:48.270555+00:00", "type": "pullrequest_comment", "id": 20117135}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/20156307.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:None..None?path=segway%2Fcluster%2F__init__.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-20156307"}}, "parent": {"id": 20117135, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/20117135.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-20117135"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "Turns out the error was occurring because the job template was being deleted regardless of if the job would be resubmitted (and thus reuse the same restartable job template). Solution is to check if job will be resubmitted and then if not, delete the job template.", "markup": "markdown", "html": "<p>Turns out the error was occurring because the job template was being deleted regardless of if the job would be resubmitted (and thus reuse the same restartable job template). Solution is to check if job will be resubmitted and then if not, delete the job template.</p>", "type": "rendered"}, "created_on": "2016-06-23T14:33:47.813418+00:00", "user": {"display_name": "Rachel Chan", "uuid": "{20430f8d-4e6b-48cc-a8d8-c64868bf7e79}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D"}, "html": {"href": "https://bitbucket.org/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/4397abec9f84e35f1f235b350984833dd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRC-1.png"}}, "nickname": "rcwchan", "type": "user", "account_id": "557058:e439e22e-8cfc-4cf1-b090-030d33a0730e"}, "inline": {"to": null, "from": null, "path": "segway/cluster/__init__.py"}, "updated_on": "2016-06-23T14:34:18.104605+00:00", "type": "pullrequest_comment", "id": 20156307}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/20170881.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:bf9909cd6fd3..02c1669515d6?path=segway%2Fcluster%2F__init__.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-20170881"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "Quick note that I've rerun this with the large run that previously failed (when the job template was being deleted prematurely), and it's now completed completely successfully.", "markup": "markdown", "html": "<p>Quick note that I've rerun this with the large run that previously failed (when the job template was being deleted prematurely), and it's now completed completely successfully.</p>", "type": "rendered"}, "created_on": "2016-06-23T18:35:53.108575+00:00", "user": {"display_name": "Rachel Chan", "uuid": "{20430f8d-4e6b-48cc-a8d8-c64868bf7e79}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D"}, "html": {"href": "https://bitbucket.org/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/4397abec9f84e35f1f235b350984833dd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRC-1.png"}}, "nickname": "rcwchan", "type": "user", "account_id": "557058:e439e22e-8cfc-4cf1-b090-030d33a0730e"}, "inline": {"to": 276, "from": null, "path": "segway/cluster/__init__.py"}, "updated_on": "2016-06-23T18:35:53.110602+00:00", "type": "pullrequest_comment", "id": 20170881}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/20171279.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/segway/diff/rcwchan/segway:bf9909cd6fd3..02c1669515d6?path=segway%2Fcluster%2F__init__.py"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-20171279"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "This comment is now misleading. There is no \"deletion\" of the restartable job when this takes place.", "markup": "markdown", "html": "<p>This comment is now misleading. There is no \"deletion\" of the restartable job when this takes place.</p>", "type": "rendered"}, "created_on": "2016-06-23T18:44:19.409878+00:00", "user": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "inline": {"to": 151, "from": null, "path": "segway/cluster/__init__.py"}, "updated_on": "2016-06-23T18:44:19.424163+00:00", "type": "pullrequest_comment", "id": 20171279}, {"links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54/comments/20171577.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54/_/diff#comment-20171577"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 54, "links": {"self": {"href": "data/repositories/hoffmanlab/segway/pullrequests/54.json"}, "html": {"href": "#!/hoffmanlab/segway/pull-requests/54"}}, "title": "Add job template deletion to cluster/common.py and cluster/__init__.py"}, "content": {"raw": "@hoffman this is ready for your review again", "markup": "markdown", "html": "<p>@hoffman this is ready for your review again</p>", "type": "rendered"}, "created_on": "2016-06-23T18:50:56.042152+00:00", "user": {"display_name": "Eric Roberts", "uuid": "{cd8c1fe0-28ca-45fb-8ef9-48090b42bb80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D"}, "html": {"href": "https://bitbucket.org/%7Bcd8c1fe0-28ca-45fb-8ef9-48090b42bb80%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/17548d71dfb29d015b880f48cfc01ca3d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsER-5.png"}}, "nickname": "ericr86", "type": "user", "account_id": "557058:c80ca578-03a1-4ac6-b3ee-50372a3fceee"}, "updated_on": "2016-06-23T18:50:56.054659+00:00", "type": "pullrequest_comment", "id": 20171577}], "page": 1, "size": 16}